---
/**
 * CSS custom properties.
 */
import { palettes } from "@src/components/app/palette";

type PaletteColors = (typeof palettes)[keyof typeof palettes]["colors"];

const cssVarNameForColorKey = (key: string): string => `--${key}Color`;

const colorsToCSS = (colors: PaletteColors, indent: string): string =>
  Object.entries(colors)
    .map(
      ([key, value]) =>
        `${indent}${cssVarNameForColorKey(key)}: ${value};`,
    )
    .join("\n");

const baseColorsCSS = colorsToCSS(palettes.defaultLight.colors, "    ");
const darkPrefColorsCSS = colorsToCSS(palettes.defaultDark.colors, "      ");

const paletteRules = Object.entries(palettes)
  .map(([id, palette]) => {
    const scheme = id === "defaultDark" ? "dark" : "light";
    return [
      `  html[data-palette="${id}"] {`,
      `    color-scheme: ${scheme};`,
      colorsToCSS(palette.colors, "    "),
      "  }",
    ].join("\n");
  })
  .join("\n\n");

const css = `
  html {
    color-scheme: light;
    /** COLORS */
${baseColorsCSS}

    /** FONTS */
    --displayFonts: "Patua One", "Lucida Bright", serif;
    --heroFonts: "Patua One", "Lucida Bright", serif;
    --heroSubtitleFonts: "Work Sans", sans-serif;
    --subtitleFonts: "Patua One", "Lucida Bright", sans-serif;
    --readingFonts: "Work Sans", sans-serif;
    --codeFonts: monaco, Consolas, "Andale Mono", "Lucida Console", monospace;

    /** Layout information. */
    --pageWidth: 73.5rem;
    --blogPostWidth: 52.5rem;
    --blogPreviewWidth: 45rem;
    --menuWidth: 35rem;
  }

  /**
   * If the user prefers dark mode, set the colors to match the
   * dark mode palette. */
  @media (prefers-color-scheme: dark) {
    html:not([data-palette]) {
      color-scheme: dark;
${darkPrefColorsCSS}
    }
  }

  /* Explicit palette selection overrides system preference. */
${paletteRules}
`.trim();
---

<style is:global is:inline set:html={css}></style>
