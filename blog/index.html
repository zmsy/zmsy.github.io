<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><base href=https://zmsy.co/><title>zmsy | Blog</title><meta name=og:title content="Blog"><meta name=description content="Recent writing and technical articles."><meta name=og:description content="Recent writing and technical articles."><link rel=stylesheet href=https://zmsy.co/css/main.css><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css><link href="https://fonts.googleapis.com/css?family=Patua+One|Work+Sans&display=swap" rel=stylesheet><link rel=icon type=image/png href=https://zmsy.co/media/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://zmsy.co/media/favicon-16x16.png sizes=16x16><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/zmsy.co\/"},"name":"Blog","headline":"Blog","description":"Recent writing and technical articles.","inLanguage":"en-US","author":"Zach Morrissey","creator":"Zach Morrissey","publisher":"Zach Morrissey","accountablePerson":"Zach Morrissey","copyrightHolder":"Zach Morrissey","copyrightYear":"2022","datePublished":"2018-01-31","dateModified":"2022-01-28T03:57:47Z","url":"https:\/\/zmsy.co\/blog\/","keywords":["Blog"]}</script></head><body><div class="columns is-centered" id=navbar-columns><div class="column is-10 is-12-touch" id=navbar-column><nav class=navbar role=navigation id=top><div class=navbar-brand><a class=navbar-item href=https://zmsy.co/><img id=logo-img src=https://zmsy.co/media/logo.svg alt="zmsy.co - Home"></a>
<a class=navbar-item href=https://zmsy.co/><div class=is-3 id=logo-text>zmsy.co</div></a><span class=navbar-burger id=navbar-toggle><span></span><span></span><span></span></span></div><div class=navbar-menu><div class=navbar-end><a class="navbar-item is-hidden-touch" href=https://www.linkedin.com/in/zmsyco><span class=icon><i class="fa fa-linkedin-square" title="View my LinkedIn profile."></i></span></a><a class="navbar-item is-hidden-touch" href=https://github.com/zmsy><span class=icon><i class="fa fa-github" title="Check out my Github."></i></span></a><a class="navbar-item is-hidden-touch" href=https://twitter.com/_zmsy><span class=icon><i class="fa fa-twitter" title="Check out my sparsely used Twitter account."></i></span></a><a class="navbar-item is-tab" href=https://zmsy.co/>Home</a>
<a class="navbar-item is-tab" href=https://zmsy.co/blog>Blog</a>
<a class="navbar-item is-tab" href=https://zmsy.co/projects>Projects</a>
<a class="navbar-item is-tab" href=https://zmsy.co/about>About</a></div></div></nav></div></div><div id=body><main><div class="columns is-centered is-desktop"><div class="column is-8 is-12-touch"><ul class=contents><section class=section><div class=blog-post><h2><a class="title title-dark is-size-2-touch" href=https://zmsy.co/blog/dev-in-the-time-of-covid-19/>Dev in the Time of COVID-19</a></h2><p class=meta>written by
<a href=https://twitter.com/_zmsy>Zach Morrissey</a>
on 2022-01-20</p><img class=image id=hero-diamonds src=https://zmsy.co/img/diamonds-dark.svg><div class=content><h2 id=been-a-while>Been a while!</h2><p>This is the first post I&rsquo;ve written here since Feb 2020. That was a long two-year gap. There&rsquo;s likely no explanation needed for most. I didn&rsquo;t keep <a href=https://zmsy.co/blog/hugo/>my promise to publish more often</a>.</p><figure><img src=https://zmsy.co/blog/dev-in-the-time-of-covid-19/clock.svg alt=Clock class=no-border style=height:15rem></figure><p>I&rsquo;m usually a voracious learner outside of work. It&rsquo;s partially due to the fact that I&rsquo;m a <a href=https://zmsy.co/blog/switching-careers-to-software-engineering-part-two/>career-switching developer</a>, and for ~3-5 years most of the gains I had in this new track came from extracurriculars. It&rsquo;s also partly due to the fact that I am always usually some combination of bored with current tasks, frustrated with current tech, or curious about new stuff. I am normally able to make time every week to try something out, watch some videos, hammer out some bad code, etc.</p><p>COVID-19 changed all of that. I&rsquo;m also a data junkie to a fault, so I&rsquo;ve been glued to case numbers, virology experts, newly released studies. I&rsquo;ve been fairly cautious throughout most of the pandemic, but I&rsquo;m not immune to anxiety. I&rsquo;ve noticed myself worrying more as I read more. As I became more anxious, I spent less time learning because I found it harder to disconnect. Now that I and my family have been vaccinated, I&rsquo;m hoping to gain some of that patience and willpower to learn on my own again.</p><h2 id=the-last-two-years>The Last Two Years</h2><p>Let&rsquo;s look at the stuff I&rsquo;ve been working with / on.</p><h3 id=typescript-everywhere>Typescript Everywhere</h3><p>This is the major technological development for me over this time. I stumbled on a nascent Typescript around when I started doing web development in earnest, circa ~2016-17. It was far from a sure thing to succeed at that point, but it&rsquo;s absolutely ubiquitous now. 100% of the frontend work that I do is in TS, and plenty of the backend work that I do as well. There&rsquo;s a lot to love here, but I think it&rsquo;s a combination of a few things:</p><figure><img src=https://zmsy.co/blog/dev-in-the-time-of-covid-19/typescript.svg alt="Typescript logo" class=no-border style=height:12rem></figure><ol><li><strong>Ecosystem</strong> - TS adoption is almost ubiquitous at this point. I rarely have to use a library without available types, and when I do it&rsquo;s not particularly difficult to wrap that in my own type-safe code.</li><li><strong>Documentation</strong> - The TS docs themselves are a comprehensive reference. Not very easy to browse/read, but <em>most</em> of the answers I need come from the docs as opposed to Stack Overflow. The only things I have to go hunting for generally are little-used or esoteric.</li><li><strong>Tooling</strong> - TS makes web development in any editor significantly better. VS Code type-checking is comprehensive enough that, once you&rsquo;ve learned the basics, it&rsquo;s <em>easier</em> to write Typescript than Javascript.</li></ol><h3 id=recipe-development>Recipe Development</h3><p>I actually learned to use cooking as my primary means of post-work relaxation during the pandemic. I&rsquo;d learned very early on that it forced me to be away from my phone. It made me use my hands.</p><figure><img src=https://zmsy.co/blog/dev-in-the-time-of-covid-19/recipe.svg alt="A written reicpe next to a cutting board." class=no-border style=height:12rem></figure><p>I started to make the same recipes over and over again. I began to jot down notes about what I&rsquo;d changed and why I changed it. Some is technique, some is using new ingredients, some is synthesizing multiple recipes that didn&rsquo;t quite work for me. I&rsquo;ve been meaning to publish a handful on this site and I intend to do that this year. I&rsquo;ve been learning how recipe SEO works.</p><h3 id=cycling>Cycling</h3><p>Another way I forced myself to disconnect from the world this year was cycling.</p><figure><img src=https://zmsy.co/blog/dev-in-the-time-of-covid-19/bike.svg alt=Bicycle class=no-border style=height:12rem></figure><p>I went from a 1x monthly to a 4x weekly rider. Due to the weather turning worse for the season, I&rsquo;ve slowed my frequency but intend to pick back up again in the spring. For a while, I felt most free and level-headed when I just suited up, threw on a podcast, and peddled as far in one direction as my legs would take me and the sunlight would last. Living in Seattle, I lose the ability to bike in the sun after work during the winters. I&rsquo;ve noticed a drastic effect on my mood from the sunlight, cardio, and general seclusion that comes from riding.</p><h2 id=whats-coming-soon>What&rsquo;s Coming Soon</h2><p>Now that we&rsquo;re into 2022, and I&rsquo;ve been a developer for over four years, what am I going to focus on next?</p><h3 id=web-web-web-web>Web Web Web Web</h3><p>I&rsquo;ve always enjoyed web development most of any type of dev-related work, but I&rsquo;m committing to making this my primary focus. I&rsquo;ve been primarily a backend dev for most of my career. I&rsquo;ve only ever been a frontend-as-needed type of person. In the past two years I cobbled together some meaningful interfaces, and it made me realize the <em>user connection</em> of developing the frontend is invigorating. Feels like I get to make tools useful in a way that the backend work just hadn&rsquo;t allowed me to.</p><p>I&rsquo;m hoping to do some experimentation with some different web technologies, ones that I&rsquo;ve not used before. UI frameworks that aren&rsquo;t React, WebAssembly, newer CSS features, performance optimization.</p><h3 id=being-offline>Being Offline</h3><p>I&rsquo;m working on strategies to be able to <em>not</em> live online all the time. This is a common struggle I&rsquo;ve noticed both in others and myself over the past few years. Even when I&rsquo;m in a time I set aside specifically to work, in a place where I&rsquo;ve got focus, I find it hard not to drift. I think that years of having entertainment be so easily accessed has done a number on my ability to concentrate.</p><p>I&rsquo;ve noticed that my favorite part of backpacking (or other off-the-grid activities) is regaining my patience and attention span during those times where I&rsquo;m not constantly drawn away from the moment by my computer or phone.</p><h3 id=creating-learning-materials>Creating Learning Materials</h3><p>My penchant for doodling on this site and my desire to make useful content is bound to collide in some way. I think I&rsquo;m going to look into creating reference materials. I love a good diagram or well-formed cheatsheet.</p><p>I&rsquo;d like to make some short-form, targeted content for learning specific frameworks, language features, or concepts. I am planning on creating a new section of the site for it, but we&rsquo;ll see how that goes. Either way, I&rsquo;d learn something out of it.</p></div></div></section><section class=section><div class=blog-post><h2><a class="title title-dark is-size-2-touch" href=https://zmsy.co/blog/hugo/>Switching to Hugo</a></h2><p class=meta>written by
<a href=https://twitter.com/_zmsy>Zach Morrissey</a>
on 2020-02-24</p><img class=image id=hero-diamonds src=https://zmsy.co/img/diamonds-dark.svg><div class=content><figure><img src=https://zmsy.co/blog/hugo/hugo.png alt="Hugo bills itself as 'The world’s fastest framework for building websites'"></figure><p>One of the biggest changes for this blog happened just now - this blog switched from Lektor to <a href=https://gohugo.io/>Hugo</a>. For me, it&rsquo;s been a revolution in how personally productive I can be. I&rsquo;m expecting that this will improve how quickly I can write and publish blog articles here and, maybe, even lead to me publishing more than 1x per ~3-6month period. I don&rsquo;t intend this to be a dead blog, and I&rsquo;m putting in the work to make that the case.</p><p>I choose technologies in a very safe way, following a pattern:</p><ol><li>Choose technologies that already have strong adoption as opposed to niche or cutting-edge.</li><li>Use technologies the way that others use them. Look for examples, re-use resources where possible.</li></ol><p>My original system didn&rsquo;t meet either of these. This is a long-overdue follow up to my first post <a href=https://zmsy.co/blog/blog-versions>about the technologies I chose the first time around</a>.</p><h2 id=choosing-a-new-static-site-generator>Choosing a New Static-Site Generator</h2><p>Primary resource used: <a href=https://www.staticgen.com>staticgen.com</a></p><p>Background, I don&rsquo;t particularly love being in the React ecosystem for scenarios when the value of React likely won&rsquo;t be realized (which is to say, highly interactive sites that benefit from one-way data flow). This site is primarily data and not interactivity, so doesn&rsquo;t necessarily lend itself to using it.</p><h3 id=why-hugo>Why Hugo?</h3><ul><li>It&rsquo;s a single binary I can install anywhere.</li><li>I&rsquo;m learning Go, and it reuses much of the Go ecosystem (notably, templating).</li><li>It&rsquo;s fast.</li><li>It takes a simple approach to the web; that it&rsquo;s a static set of HTML, CSS, and JS files. While you can wrap a build system like Webpack or Gulp in, it provides enough out-of-the-box features using <a href=https://gohugo.io/hugo-pipes/>Hugo Pipes</a> that it may not be necessary.</li><li>Batteries included: Useful shortcodes, deployment targets, integrations.</li><li>It&rsquo;s one of the supported static site generators for <a href=https://www.netlifycms.org/>Netlify CMS</a>, which is what I intend to use to write content from here on out.</li><li>The other obvious options, considering their popularity, are Gatsby and Next.js, but this site is largely static content and doesn&rsquo;t necessitate the React ecosystem.</li><li>Support for some automatic content systems like <a href=https://gohugo.io/content-management/taxonomies>Taxonomies</a> and <a href=https://gohugo.io/content-management/archetypes/#readout>Archetypes</a>.</li></ul><h3 id=why-_not_-hugo>Why <em>Not</em> Hugo?</h3><p>In building the site on Hugo, there were a number of things that I encountered that I didn&rsquo;t love; they were few and far between though.</p><ul><li>Examples. The biggest single deficiency of Hugo as a static-site generator is that the examples provided by the documentation aren&rsquo;t great. I&rsquo;ve got <a href=https://zmsy.co/blog/example-first-documentation>strong feelings about this</a> and I&rsquo;m going to try to see if I can note times where this is missing and submit those as MRs.</li><li>Template debugging. Aside from <code>printf</code>ing a bunch of variables, I didn&rsquo;t find the mechanisms for figuring out what data is available where to be particularly useful (not that other SSGs have this down, though).</li><li>Template Lookup Order. Error messages are confusing and it&rsquo;s hard to figure out where things slot into. The warnings that the hugo builder provides could be so much more useful.</li><li>As of writing, Netlify CMS doesn&rsquo;t yet support page bundles (although this should be available soon).</li></ul><h3 id=why-not-lektor-any-more>Why Not Lektor (any more)?</h3><p>My needs for the website have changed pretty drastically from when I first built it in 2016 and wrote things for it in 2018.</p><ul><li>It&rsquo;s not popular (ranked ~30th on StaticGen for static-site generators), and it&rsquo;s not growing in popularity.</li><li>I don&rsquo;t really use Python for anything web-facing, which is one of the reasons I originally stuck with Lektor.</li><li>Not enough batteries included. Many integrations are abandoned or haven&rsquo;t been updated in forever.</li><li>Bad writing ergonomics. The editing page isn&rsquo;t very helpful, and it doesn&rsquo;t actually help you create content faster. There once was a Electron app that theoretically a headless CMS for the software, but it was quickly abandoned.</li></ul><h2 id=build--deploy>Build & Deploy</h2><p>This site is now built and deployed using <a href=https://github.com/features/actions>Github Actions</a>, which are similar to Gitlab CI in form and function but are much easier to get up and going with if your repository is hosted there.</p></div></div></section><section class=section><div class=blog-post><h2><a class="title title-dark is-size-2-touch" href=https://zmsy.co/blog/example-first-documentation/>Example-first Documentation</a></h2><p class=meta>written by
<a href=https://twitter.com/_zmsy>Zach Morrissey</a>
on 2019-07-07</p><img class=image id=hero-diamonds src=https://zmsy.co/img/diamonds-dark.svg><div class=content><p>When I read through your <code>(library|module|framework)</code>&rsquo;s documentation I will skip everything and scan until I find the first example.</p><p>The one unifying thing about many programmers is that they&rsquo;re driven towards problem-solving, and they&rsquo;re going to have a goal set when the finally reach your documentation. Documentation that aims to identify those goals and solve them as directly as possible is the best documentation. Users want the fastest way to prove and/or disprove their hypothesis.</p><p>The most direct way, you might imagine, is examples. Lots of examples. Everywhere. Nothing comes close to how useful <em>actual usage</em> is.</p><h2 id=two-common-ways-i-use-documentation>Two Common Ways I Use Documentation</h2><ol><li>Checking how closely your examples match my intended use case. Everyone has a mental model of how they think a particular library will work prior to using it, and they will try to navigate to the right pages by searching for terms related to that. If this mental model is wrong, it&rsquo;s important to know why that is and provide examples for what the alternatives look like.</li><li>Attempt to install your software in a variety of ways I already know, and fall back to reading the &ldquo;Getting Started&rdquo; page when that doesn&rsquo;t work.</li></ol><p>More specifically, if users can&rsquo;t see the actual functions or classes they intend to use demonstrated, they will avoid your framework entirely.</p><p>Although you&rsquo;ll see more seasoned engineers throw around &ldquo;RTFM&rdquo; or other phrases extolling the virtues of painstakingly reading the manpages of a particular tool, but I will always have a shorter-term goal in mind than holistic understanding. Most documentation is intended as reference, but there still exists a large spectrum of user experience in navigating that reference information.</p><h2 id=reasons-whey-theyre-looking-for-examples>Reasons Whey They&rsquo;re Looking For Examples</h2><figure><img src=https://zmsy.co/blog/example-first-documentation/rtfm.svg alt="Ternary JS operator describing how seniors feel about juniors' questions when they're not 100% well-researched." class=no-border></figure><ol><li>Starting off and want a frame of reference.</li><li>Users know what an implementation might look like, but don&rsquo;t know what it&rsquo;s called.</li><li>StackOverflow-inspired copy/paste-heavy workflow.</li><li>Asking for help on the internet sucks.</li><li>Asking for help from your coworkers can suck too.</li></ol><p>If you believe it&rsquo;s easiest to get started using a framework if the examples are good, then it&rsquo;s truly the most user-focused way of helping your users out. It&rsquo;s the quickest route from intention to implementation.</p><h2 id=model-your-docs-after-successful-software>Model Your Docs After Successful Software</h2><p>There are an endless number of under-documented pieces of code out there, and their success or failure is largely driven around how quickly users can get at the answer that fits their mental model of how your library works.</p><p>Leaving some examples of great examples-driven documentation here:</p><ul><li><a href=https://reactjs.org/docs/hello-world.html>React, starting with the &ldquo;Hello World!&rdquo; bits</a></li><li><a href=https://black.readthedocs.io/en/stable/>Black python formatter</a></li><li><a href=https://github.com/jmoiron/sqlx#usage>Go&rsquo;s sqlx starter page</a></li></ul></div></div></section><section class=section><div class=blog-post><h2><a class="title title-dark is-size-2-touch" href=https://zmsy.co/blog/personal-data-engineering/>An Architecture For Personal Data Engineering</a></h2><p class=meta>written by
<a href=https://twitter.com/_zmsy>Zach Morrissey</a>
on 2019-03-26</p><img class=image id=hero-diamonds src=https://zmsy.co/img/diamonds-dark.svg><div class=content><p>Performing in-depth data analyses on things in my own life have always been more difficult than in my working life, primarily because there I&rsquo;ve normally had teams of engineers who have helped in setting up and maintaining most of the analytics-focused infrastructure that I&rsquo;ve used. Supporting myself with the same sort of infrastructure I was used to was an adventure, <a href=https://zmsy.co/blog/my-very-own-airflow-cluster/>one that started much earlier</a> and has since grown from there.</p><figure><img src=https://zmsy.co/blog/personal-data-engineering/graphs.svg alt="Miscellaneous fake graphs for fun." class=no-border style=width:20rem;height:10rem></figure><h2 id=scope>Scope</h2><p>To most ends, downloading CSVs and plugging them into your spreadsheet software of choice will do most tasks well enough. For my purposes though, I wanted to scale this past what manual analysis was going to get me. There&rsquo;s a few key areas that I wanted this for:</p><ul><li>Personal finances. Most of the data that I create finds it&rsquo;s way into financial systems that are hard to get your information out of. I&rsquo;m not against the bank having my spending data, but I am frustrated that it&rsquo;s so hard for me to get it too.</li><li>Fantasy sports. I love sports and I love stats.</li><li>House shopping. This data is heaaaavily guarded and it&rsquo;s hard to find anything that isn&rsquo;t breaking some sort of ToS to get.</li></ul><p>This doesn&rsquo;t necessarily create a system that requires dedicated data engineering work, but some of the goals that I had for it did. These were:</p><ul><li><strong>Automated.</strong> I&rsquo;d like to see how repeatable and reproducible these analyses can be.</li><li><strong>Modeled.</strong> I&rsquo;d like to build and train some models related to how I live my life to see if there&rsquo;s any predictive benefit to these things.</li><li><strong>Interactive.</strong> - For everything that you see here, I&rsquo;d like to have some sort of interface that I can open, preferably via web browser.</li></ul><h2 id=the-bits-n-pieces>The Bits n' Pieces</h2><p>For doing this sort of work, I set up a few infrastructural components. Hardware is a low-spec server with <a href=https://www.proxmox.com/en/>Proxmox</a> (for VMs) and Docker/<a href=https://www.portainer.io/>Portainer</a>.</p><figure><img src=https://zmsy.co/blog/personal-data-engineering/diagram.svg alt="Diagram of my personal data engineering architecture." class=no-border style=max-height:20rem></figure><ul><li><strong>Postgres database</strong> - My primary datastore. This is the hub of all activity that I do, serving as both an application backend / transactional database as well as an analytical database. Each are neatly separated out into different schemas. I use <a href=https://dbeaver.io/>DBeaver</a> as a SQL client for ad-hoc querying, manipulation, setup, etc. Since a single Postgres instance can scale to vastly larger workloads than I&rsquo;d ever be able to throw at it, this seemed like a good backbone for everything.</li><li><strong>Apache Airflow</strong> - In it&rsquo;s simplest form, I&rsquo;m using this basically as a scheduled job engine. Building on my <a href=%22/blog/my-very-own-airflow-cluster/%22>earlier post about Airflow</a>, I&rsquo;ve expanded my usage of it to a significant variety of different DAGs. This uses the same Postgres database as earlier.</li><li><strong>Jupyter Notebooks</strong> - Interactive analytical code/markdown files served up in your web browser. Jupyter is the ultimate tool in interactive analytical computing, with RStudio being the only major other option I considered (went with Jupyter, if for nothing else, because I find python more enjoyable to write). There&rsquo;s <a href=https://jupyterhub.readthedocs.io/en/stable/>great options</a> available if you want to run this on a server, I found that I like just running it locally the best.</li><li><strong>Apache Superset</strong> - Web-based Dashboards. <a href=https://superset.incubator.apache.org/installation.html#getting-started>Superset</a>, similar to Airflow, is based on Python/Flask and can be run in a single Docker container if you so desire. Since I need some way of sharing some of these results with a significant other (namely finance + house shopping data), I needed to have some sort of dashboarding software in order to have that visible to someone who will access it via web browser.</li></ul><h2 id=my-workflow>My Workflow</h2><p>Since the pieces have been set in place now, this is my general workflow:</p><figure><img src=https://zmsy.co/blog/personal-data-engineering/process.svg alt="Process workflow from Airflow task to Jupyter notebook and then to Superset dashboard." class=no-border style=max-height:12rem></figure><ol><li>Find a new datasource. Generally, this is something scraped from the web or pulled from a service I use.</li><li>Write an Airflow task to pull that data on a regular schedule (normally nightly).</li><li>In Postgres, create schema / table in order to store info.</li><li>Use downstream in:<ol><li>Superset dashboard. This is normally when I&rsquo;ve created a datasource that I&rsquo;m interested in (i.e. personal spending data) and want to look at from a variety of angles.</li><li>Jupyter notebook. Normally, this is to either create a more in-depth analysis (any modelling required) or to investigate one hunch / idea that I&rsquo;ve got. In the event that I something useful to replicate, I ship this upstream into an Airflow task.</li><li>Exported to some sort of printable / shareable thing. Good example for this is pre-draft research for fantasy sports.</li></ol></li></ol><h2 id=tips>Tips</h2><p>This was a fun adventure to go on, but I&rsquo;m happy that it&rsquo;s stabilized by this point.</p><ul><li>It&rsquo;s fun stuff. It really is. Using data to analyze parts of your own life is something people rarely get to do.</li><li>There&rsquo;s a tradeoff between having a robust, feature-filled system and an easy one. As your needs change, your tools tend to change too. My aims for this outgrew my cron/jupyter/Google Sheets hackjob before trying to take on any of this.</li><li>Getting data is the hardest part. Significantly more time for me is spent writing data fetching tasks than anything else.</li></ul></div></div></section><section class=section><div class=blog-post><h2><a class="title title-dark is-size-2-touch" href=https://zmsy.co/blog/building-dynamic-dungeons-using-unity-tilemaps/>Building Dynamic Dungeons using Unity Tilemaps</a></h2><p class=meta>written by
<a href=https://twitter.com/_zmsy>Zach Morrissey</a>
on 2019-02-11</p><img class=image id=hero-diamonds src=https://zmsy.co/img/diamonds-dark.svg><div class=content><p>In one of the last projects I&rsquo;m doing for school, I&rsquo;m working on a game wherein everything in the game is <em>procedurally generated</em> using a dungeon-building algorithm.</p><h2 id=fresh-content-each-time>Fresh Content Each Time</h2><p>One of the main draws of building a <a href=https://en.wikipedia.org/wiki/Roguelike>Roguelike game</a> is figuring out how to procedurally generate dungeons. While it&rsquo;s difficult to replicate the high-quality hand-crafted content of titles like <em>Legend of Zelda: A Link to the Past</em>, you can approximate a lot of the same experience while coming up with a new layout each time the game is loaded.</p><p>Achieving this is, as you may imagine, pretty difficult.</p><p>There are a lot of resources online, but most of them follow the same pattern - create a set of rooms, connect them, place items within them. There&rsquo;s a significant amount of wiggle room within those, but that&rsquo;s the basics.</p><figure><img src=https://zmsy.co/blog/building-dynamic-dungeons-using-unity-tilemaps/dungeon_of_deneb_capture.png alt="The Dungeon of Deneb logo and intro scene"></figure><h2 id=unity-set-up>Unity Set Up</h2><p>The dungeon I built is based on a Unity Tilemap, which is effective a grid of 1x1 squares that you can place tiles within. For the game that I&rsquo;m working on, I made each tile 16x16 pixels (you can set them to the density that you&rsquo;re planning on making your tile sprites).</p><p>The unity objects involved:</p><ul><li>Two tilemaps (Created by Game Object > 2D Object > Tilemap). Spawning a tilemap will create a Grid object as its parent. I created two Tilemaps and connected them to the same parent. I attached my <code>Dungeon.cs</code> building script as a component to this parent.<ul><li>Floor tilemap - This is what I use to tile the floor background, and this is the main data for the dungeon layout (since walls are just created using the floor layout).</li><li>Walls (Collidable) tilemap - This one has a collider added to it, so the player can&rsquo;t walk through them.</li></ul></li><li>Tile Palette - This contains all of the floor / wall tiles that I use to build the dungeon. It&rsquo;s nice to have one of these so you can manually paint some on if you want.</li></ul><figure><img src=https://zmsy.co/blog/building-dynamic-dungeons-using-unity-tilemaps/tile_palette.png alt='The "Dungeon Simplified" tile palette in the Unity Sidebar.'></figure><h2 id=the-algorithm>The Algorithm</h2><p>Since dungeon generation algorithms can fall into a number of ways that they can end up in an infinite loop where they will <em>never</em> end up with a good dungeon layout, it&rsquo;s best to program each step of this in the following way:</p><ul><li>While not at my limit of tries</li><li>Try</li><li>If failed, reset everything and increment how many tries I&rsquo;ve done.</li></ul><h3 id=steps>Steps</h3><ol><li>Place a number of rooms in a grid.</li><li>Derive a graph for the grid. The recommended way I found to do this was to create a Delauney Triangulation. This is somewhat complicated, so it&rsquo;s recommended to <a href=http://www.personal.psu.edu/cxc11/AERSP560/DELAUNEY/13_Two_algorithms_Delauney.pdf>find an algorithm or package that will do this for you</a>.</li><li>From that graph, derive a minimum spanning tree. I found that this was easy enough to do using Prim&rsquo;s Algorithm, which is greedy and runs quickly.</li><li>Verify that the graph meets your desired gameplay goals. For me, I wanted to make sure that I had at least two non-overlapping subtrees that comprised >25% of the nodes in the tree, so that I could use these as specific gameplay areas.</li><li>Connect all the parent/child relationships in the tree with corridors.</li><li>Once that&rsquo;s done, add some optional corridors for the nodes within the same subtree, so that you can remove the perfect &ldquo;tree&rdquo;-ness of the layout and add some variety to it.</li><li>Choose a boss room. For mine, I simply chose a leaf node in the larger subtree with a higher-than-average floor area.</li><li>Choose rooms to place keys in that will open locked doors.</li><li>Lock the doors.</li><li>Place items and enemies within those rooms according to some sort of sliding difficulty scale. You can easily derive this difficulty on a number of simple heuristics (i.e. bigger room = more enemies, further depth in tree = harder enemies, etc).</li></ol><p>Go!</p><h2 id=layouts-generated>Layouts Generated</h2><p>First, a key, so you can understand what you&rsquo;re looking at:</p><ul><li>Rooms:<ul><li>Green / White = starting room / starting area</li><li>Red = boss room</li><li>Light blue = harder-than-starter area, Dark Blue = advanced area</li><li>Yellow = room with a key</li></ul></li><li>Corridors:<ul><li>White - Parent/child relationship in tree</li><li>Yellow - Optional corridor added between two rooms in the same subtree.</li></ul></li></ul><figure><img src=https://zmsy.co/blog/building-dynamic-dungeons-using-unity-tilemaps/dungeon_layout_1.png alt="Dungeon Layout 1"></figure><p>The key to the light blue area spawns in the green / white area, the key to the dark blue area spawns in the light blue area. The key to the boss room is placed within the dark blue area.</p><figure><img src=https://zmsy.co/blog/building-dynamic-dungeons-using-unity-tilemaps/dungeon_layout_2.png alt="Dungeon Layout 2"></figure><p>As you can see in this one, sometimes the room with a key in it spawns <em>directly</em> next to the boss (in the first example above), but sometimes it&rsquo;s located fairly far away in a different corner (in this example, on the bottom left).</p><figure><img src=https://zmsy.co/blog/building-dynamic-dungeons-using-unity-tilemaps/dungeon_layout_3.png alt="Dungeon Layout 3"></figure><p>In this example, I&rsquo;ve included the minimum spanning tree generated during the dungeon building process. If you note the yellow corridors between rooms, those are randomly added between rooms within the same subtree.</p><h2 id=applying-tiles>Applying Tiles</h2><p>The <a href=https://docs.unity3d.com/ScriptReference/Tilemaps.Tilemap.SetTile.html><code>TileMap.SetTile</code></a> function can then be used to programmatically fill out which tiles are supposed to go where. Once you&rsquo;ve got the room data figured out, it&rsquo;s pretty easy to determine where to set tiles (floor tiles set within any room or corridor, wall tiles set in any empty space that borders a corridor or room).</p><p>The result:</p><figure><img src=https://zmsy.co/blog/building-dynamic-dungeons-using-unity-tilemaps/dungeon_layout_tiled.png alt="Dungeon Layout with tiles applied to the TileMap"></figure><p>From here, you can generate the items and enemies how you see fit.</p></div></div></section></ul><div class=pagination><span class=disabled>&#171; Previous</span>
<span>| 1 |</span>
<a href=https://zmsy.co/blog/page/2/>Next &#187;</a></div></div></div></main></div><footer class=footer><div class="container has-text-centered"><p id=footer-text><strong>zmsy.co</strong> - A personal blog by Zach Morrissey. Copyright © 2022. Hosted via <a href=https://pages.github.com/>Github Pages</a>.</p><p><img class=footer-dots src=https://zmsy.co/img/footer.svg alt="Five horizontal hand-drawn dots."></p></div></footer><script type=text/javascript src=https://zmsy.co/ts/index.js></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-104524581-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>